# Maintainer: Your Name <your.email@example.com>
pkgname=e2e-seo-desktop
pkgver=1.0.0
pkgrel=1
pkgdesc="A cross-platform desktop application for comprehensive SEO analysis"
arch=('x86_64')
url="https://github.com/yourusername/e2e-seo"
license=('MIT')
depends=('webkit2gtk' 'gtk3' 'libappindicator-gtk3' 'openssl' 'librsvg')
makedepends=('npm' 'cargo' 'nodejs')
source=()
sha256sums=()

prepare() {
  mkdir -p "$srcdir/e2e-seo"
  # Copy project files to srcdir, excluding build artifacts to ensure clean build if possible, 
  # but for speed we might just copy everything. 
  # Using cp -r to copy from project root (../../)
  cp -r "$startdir/../../"/* "$srcdir/e2e-seo/"
}

build() {
  cd "$srcdir/e2e-seo"
  npm install
  cd desktop-app && npm install && cd ..
  npm run build
  npm run desktop:build
}

package() {
  cd "$srcdir/e2e-seo"
  
  # Install the binary
  install -Dm755 "src-tauri/target/release/app" "$pkgdir/usr/bin/$pkgname"
  
  # Install icons
  install -Dm644 "src-tauri/icons/32x32.png" "$pkgdir/usr/share/icons/hicolor/32x32/apps/$pkgname.png"
  install -Dm644 "src-tauri/icons/128x128.png" "$pkgdir/usr/share/icons/hicolor/128x128/apps/$pkgname.png"
  
  # Create desktop entry
  mkdir -p "$pkgdir/usr/share/applications"
  cat > "$pkgdir/usr/share/applications/$pkgname.desktop" <<EOF
[Desktop Entry]
Type=Application
Name=E2E SEO Desktop
Comment=Comprehensive SEO analysis tool
Exec=$pkgname
Icon=$pkgname
Categories=Development;WebDevelopment;
EOF
}
